Range.inclusive(p._1._2,

if (points.filter(x => x._2 == "right" && x._1._1 == p._1._1 && x._1._2 > p._1._2).map(_._1._2).size > 0) points.filter(x => x._2 == "right" && x._1._1 == p._1._1 && x._1._2 > p._1._2).map(_._1._2).sorted.head else 0
